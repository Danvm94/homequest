{% load static %}
{% load i18n %}
{% load account socialaccount %}
{% if not user.is_authenticated %}
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="login modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Login</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="loginForm" class="login" method="POST" action="{% url 'account_login' %}">
                    <div class="modal-body">
                        <div id="loginFormErrors" class="center-contents"></div>
                        <div class="d-flex justify-content-center">
                            <img src="{% static 'images/house-login.webp' %}" width="240" alt="modern house">
                        </div>

                        {% csrf_token %}
                        {{ loginform }}
                        {% if redirect_field_value %}
                            <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}"/>
                        {% endif %}

                        <a class="text-success"
                           href="{% url 'account_reset_password' %}">{% trans "Forgot Password?" %}</a>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-success">{% trans "Sign In" %}</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
{#    <script>// Script used for ajax on loginForm, preventing its default submit behaviour#}
{#    $(document).ready(function () {#}
{#        $('#loginForm').submit(function (e) {#}
{#            e.preventDefault();#}
{#            const serializedData = $(this).serialize(); // Serialize the form data#}
{#            $.ajax({#}
{#                type: 'POST',#}
{#                url: $(this).attr('action'),#}
{#                data: serializedData, // Use the serialized data#}
{#                dataType: 'json',#}
{#                success: function (data) {#}
{#                    if (data.form) {#}
{#                        window.location.reload();#}
{#                    }#}
{#                },#}
{#                error: function (data, xhr, status, error) {#}
{#                    // Show the error message from the server#}
{#                    $('#loginFormErrors').show().html(`<p class="text-danger">${data["responseJSON"].form.errors}</p>`);#}
{#                }#}
{#            });#}
{#        });#}
{#    });</script>#}
{% endif %}